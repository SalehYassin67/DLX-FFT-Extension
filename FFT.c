#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define PI 3.14159265358979323846

typedef struct {
    double real;
    double imag;
} Complex;

// Function to calculate twiddle factors and store them in an array
void calculate_twiddle_factors(Complex *W, int n) {
    for (int k = 0; k < n / 2; k++) {
        double t = -2 * PI * k / n;
        W[k].real = cos(t);
        W[k].imag = sin(t);
    }
    if (n==8){
        W[0].real = 1;
        W[1].real = 0;
        W[2].real = -1;
        W[3].real = 0;
        W[0].imag = 0;
        W[1].imag = -1;
        W[2].imag = 0;
        W[3].imag = 1;
    }
    if (n==16){
        W[0].real = 1;
        W[1].real = 0;
        W[2].real = -1;
        W[3].real = 0;
        W[4].real = 1;
        W[5].real = 0;
        W[6].real = -1;
        W[7].real = 0;
        W[0].imag = 0;
        W[1].imag = -1;
        W[2].imag = 0;
        W[3].imag = 1;
        W[4].imag = 0;
        W[5].imag = -1;
        W[6].imag = 0;
        W[7].imag = 1;
    }
    if (n==32){
        W[0].real = 1;
        W[1].real = 1;
        W[2].real = -1;
        W[3].real = 1;
        W[4].real = 1;
        W[5].real = 1;
        W[6].real = -1;
        W[7].real = 1;
        W[8].real = 1;
        W[9].real = 1;
        W[10].real = -1;
        W[11].real = 1;
        W[12].real = 1;
        W[13].real = 1;
        W[14].real = -1;
        W[15].real = 1;
        W[0].imag = 1;
        W[1].imag = -1;
        W[2].imag = 1;
        W[3].imag = 1;
        W[4].imag = 1;
        W[5].imag = -1;
        W[6].imag = 1;
        W[7].imag = 1;
        W[8].imag = 1;
        W[9].imag = -1;
        W[10].imag = 1;
        W[11].imag = 1;
        W[12].imag = 1;
        W[13].imag = -1;
        W[14].imag = 1;
        W[15].imag = 1;
    }
    if (n==64){
        W[0].real = 1;
        W[1].real = 1;
        W[2].real = -1;
        W[3].real = 1;
        W[4].real = 1;
        W[5].real = 1;
        W[6].real = -1;
        W[7].real = 1;
        W[8].real = 1;
        W[9].real = 1;
        W[10].real = -1;
        W[11].real = 1;
        W[12].real = 1;
        W[13].real = 1;
        W[14].real = -1;
        W[15].real = 1;
        W[16].real = 1;
        W[17].real = 1;
        W[18].real = -1;
        W[19].real = 1;
        W[20].real = 1;
        W[21].real = 1;
        W[22].real = -1;
        W[23].real = 1;
        W[24].real = 1;
        W[25].real = 1;
        W[26].real = -1;
        W[27].real = 1;
        W[28].real = 1;
        W[29].real = 1;
        W[30].real = -1;
        W[31].real = 1;
        W[0].imag = 1;
        W[1].imag = -1;
        W[2].imag = 1;
        W[3].imag = 1;
        W[4].imag = 1;
        W[5].imag = -1;
        W[6].imag = 1;
        W[7].imag = 1;
        W[8].imag = 1;
        W[9].imag = -1;
        W[10].imag = 1;
        W[11].imag = 1;
        W[12].imag = 1;
        W[13].imag = -1;
        W[14].imag = 1;
        W[15].imag = 1;
        W[16].imag = 1;
        W[17].imag = -1;
        W[18].imag = 1;
        W[19].imag = 1;
        W[20].imag = 1;
        W[21].imag = -1;
        W[22].imag = 1;
        W[23].imag = 1;
        W[24].imag = 1;
        W[25].imag = -1;
        W[26].imag = 1;
        W[27].imag = 1;
        W[28].imag = 1;
        W[29].imag = -1;
        W[30].imag = 1;
        W[31].imag = 1;
    }
    if (n == 128) {
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 2) {
                W[i].real = -1;
            } else {
                W[i].real = 1;
            }
        }
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 1) {
                W[i].imag = -1;
            } else {
                W[i].imag = 1;
            }
        }
    }
    if (n == 256) {
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 2) {
                W[i].real = -1;
            } else {
                W[i].real = 1;
            }
        }
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 1) {
                W[i].imag = -1;
            } else {
                W[i].imag = 1;
            }
        }
    }
    if (n == 512) {
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 2) {
                W[i].real = -1;
            } else {
                W[i].real = 1;
            }
        }
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 1) {
                W[i].imag = -1;
            } else {
                W[i].imag = 1;
            }
        }
    }
    if (n == 1024) {
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 2) {
                W[i].real = -1;
            } else {
                W[i].real = 1;
            }
        }
        for (int i = 0; i < n/2; i++) {
            if (i % 4 == 1) {
                W[i].imag = -1;
            } else {
                W[i].imag = 1;
            }
        }
    }
    

}

// Function to perform the FFT using pre-calculated twiddle factors
void fft(Complex *X, Complex *W, int n) {
    if (n <= 1) return;

    // Divide
    Complex *even = (Complex*) malloc(n/2 * sizeof(Complex));
    Complex *odd = (Complex*) malloc(n/2 * sizeof(Complex));
    for (int i = 0; i < n / 2; i++) {
        even[i] = X[i*2];
        odd[i] = X[i*2 + 1];
    }

    // Conquer
    fft(even, W, n/2);
    fft(odd, W, n/2);

    // Combine
    for (int k = 0; k < n / 2; k++) {
        Complex e = even[k];
        Complex o = odd[k];
        Complex twiddle = W[k * (n / 2) / (n / 2)]; // Use pre-calculated twiddle factors

        X[k].real = e.real + (twiddle.real * o.real - twiddle.imag * o.imag);
        X[k].imag = e.imag + (twiddle.real * o.imag + twiddle.imag * o.real);
        X[k + n/2].real = e.real - (twiddle.real * o.real - twiddle.imag * o.imag);
        X[k + n/2].imag = e.imag - (twiddle.real * o.imag + twiddle.imag * o.real);
        
        
    }

    free(even);
    free(odd);
}

int main() {
    int n = 256; // Size of the input
    //Complex X[] = {{1,5},{2,8},{9,-4},{7,-1}};
    //n = 8;
    //Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};
    //n=  16;
    //Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};
    //n= 32
    //Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};
    //n = 64
    //Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};
    //n = 128
    //Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
    //               {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};
    //n = 256;
    Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                   {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};
    //n = 512
    /*Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
                {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};*/
    //n = 1024
    /*Complex X[] = {{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},
        {1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1},{1,5},{2,8},{9,-4},{7,-1},{1,5},{2,8},{2,8},{7,-1}};*/
    
    // Allocate memory for twiddle factors and calculate them
    Complex *W = (Complex*) malloc(n/2 * sizeof(Complex));
    calculate_twiddle_factors(W, n);
    // Perform FFT using pre-calculated twiddle factors
    fft(X, W, n);
    printf("Printing fft output for n = %d:\n",n);
    printf("| ");
    for (int i = 0; i < n; i++) {
        printf("X[%d].real = %8x | ", i, (int)round(X[i].real));
    }
    printf("\n");

    printf("| ");

    for (int i = 0; i < n; i++) {
        printf("X[%d].imag = %8x | ", i, (int)round(X[i].imag));
    }
    //printf("| ");
    printf("\n");
    free(W);
    return 0;
}

